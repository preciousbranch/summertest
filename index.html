<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>夏季課題 確認テスト（単一HTML）</title>
<link rel="manifest" href="data:application/manifest+json,{"name": "夏季課題 確認テスト", "short_name": "夏季課題テスト", "start_url": ".", "display": "standalone", "background_color": "#ffffff", "theme_color": "#0ea5e9", "icons": []}">
<style>
  :root { --bg:#fafafa; --panel:#ffffff; --text:#111; --muted:#666; --accent:#0ea5e9; --ok:#16a34a; --bad:#dc2626; }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Hiragino Kaku Gothic ProN','Noto Sans JP',sans-serif; }
  .wrap{max-width:920px;margin:0 auto;padding:16px;}
  header{position:sticky;top:0;background:var(--panel);border-bottom:1px solid #eee;z-index:10}
  header .bar{display:flex;gap:8px;align-items:center;flex-wrap:wrap;padding:10px 0;}
  h1{font-size:20px;margin:8px 0;}
  select,button,input[type="checkbox"]{font-size:16px;padding:8px;border-radius:8px;border:1px solid #ddd;background:#fff}
  button.primary{background:var(--accent);color:#fff;border:0}
  .card{background:var(--panel);border:1px solid #eee;border-radius:14px;box-shadow:0 2px 8px rgba(0,0,0,.04);padding:16px;margin:14px 0;}
  .meta{font-size:12px;color:var(--muted)}
  .qtext{font-size:18px;line-height:1.6;margin:8px 0 12px}
  .choices{display:flex;flex-direction:column;gap:8px;margin:8px 0}
  .choice{padding:10px;border:1px solid #ddd;border-radius:10px;background:#fff;cursor:pointer}
  .choice:hover{border-color:#bbb}
  .fitb{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .fitb input{flex:1}
  .res{font-size:18px;margin-top:10px}
  .ok{color:var(--ok)} .bad{color:var(--bad)}
  .ex{margin-top:6px;color:#333;background:#f7fafc;border:1px dashed #cbd5e1;padding:10px;border-radius:8px;font-size:14px}
  .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .pill{font-size:12px;padding:4px 8px;border-radius:999px;background:#eef;display:inline-block;margin-right:6px}
  .footer{color:#777;font-size:12px;margin:20px 0 60px}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <h1>夏季課題 確認テスト</h1>
    <div class="bar">
      <label>モード：
        <select id="mode">
          <option value="study">学習モード</option>
          <option value="exam">試験モード</option>
        </select>
      </label>
      <label><input type="checkbox" id="shuffle" checked> シャッフル</label>
      <label><input type="checkbox" id="shuffleChoices" checked> 選択肢シャッフル</label>
      <label><input type="checkbox" id="saveScore" checked> スコア保存</label>
      <button id="start" class="primary">開始 / 最初から</button>
      <button id="mistOnly" title="間違えた問題のみ復習">暗記モード</button>
      <span id="status" class="meta"></span>
    </div>
  </div>
</header>

<div class="wrap">
  <div id="quiz"></div>
  <div class="footer">
    <div>最終更新：2025-09-05 11:20 ／ 単一HTML（iPhone Safari互換）</div>
    <div>機能：正解時は「◯」、正誤に関わらず解説表示／学習⇄試験モード／シャッフル／暗記モード（間違いのみ）／最初からボタン／簡易PWA</div>
    <div>更新方法：このHTML中の <code>const QBANK = []</code> を修正。IDは <code>Q001</code> 形式。変更依頼は「Q[番号]：『旧文』→『新文』」のルールで。</div>
  </div>
</div>

<script>
const QBANK = [{"id": "Q001", "section": "国語表現法", "type": "mc", "question": "英語に『敬語の文法』はない。（　）英語にも丁寧な表現はある。", "choices": ["つまり", "しかし", "そして", "だから"], "answer": 1, "explanation": "逆接なので『しかし』。"}, {"id": "Q002", "section": "国語表現法", "type": "mc", "question": "彼のレポートは着眼点が面白い。（　）ものの見方、視点が独特なのだ。", "choices": ["つまり", "しかし", "そして", "だから"], "answer": 0, "explanation": "言い換えの『つまり』。"}, {"id": "Q003", "section": "国語表現法", "type": "mc", "question": "記者は資料を読み込んでいた。（　）質問も鋭かった。", "choices": ["しかし", "だから", "そして", "つまり"], "answer": 2, "explanation": "順接で並列の『そして』。"}, {"id": "Q004", "section": "国語表現法", "type": "mc", "question": "現存している作品は少ない。（　）寡作だったからなおさら希少だ。", "choices": ["しかし", "つまり", "だから", "しかも"], "answer": 3, "explanation": "付加の『しかも』。"}, {"id": "Q005", "section": "国語表現法", "type": "mc", "question": "鎮痛剤を処方してもらった。（　）痛みがひどくなければ飲まないように言われた。", "choices": ["ただし", "しかし", "だから", "つまり"], "answer": 0, "explanation": "条件付きの『ただし』。"}, {"id": "Q006", "section": "情報リテラシー", "type": "fitb", "question": "ファイルとは、音楽・写真・映像・文書などの（　）の記録物のこと。", "answers": ["単一", "ひとつ", "単体"], "explanation": "『単一』の記録物。"}, {"id": "Q007", "section": "情報リテラシー", "type": "fitb", "question": "フォルダとは、さまざまなファイルを保管する（　）のこと。", "answers": ["入れ物", "容れ物", "ディレクトリ", "フォルダー"], "explanation": "『入れ物』= ディレクトリ。"}, {"id": "Q008", "section": "情報リテラシー", "type": "fitb", "question": "盗用とは、他人の所有になるものを（　）で使用すること。", "answers": ["無断", "むだん"], "explanation": "『無断』で使用すること。"}, {"id": "Q009", "section": "情報リテラシー", "type": "fitb", "question": "剽窃とは、他人の作品や論文を盗んで、（　）のものとして発表すること。", "answers": ["自分", "じぶん"], "explanation": "『自分のもの』として発表。"}, {"id": "Q010", "section": "情報リテラシー", "type": "fitb", "question": "これらは（　）侵害にもあたるので、出典の明記が重要。", "answers": ["著作権", "ちょさくけん"], "explanation": "著作権侵害。"}, {"id": "Q011", "section": "医療倫理学", "type": "fitb", "question": "基本六法のうち、『罪と罰』を規定するのは（　）法。", "answers": ["刑", "刑法"], "explanation": "刑法。"}, {"id": "Q012", "section": "医療倫理学", "type": "fitb", "question": "『身分と財産』を規定するのは（　）法。", "answers": ["民", "民法"], "explanation": "民法。"}, {"id": "Q013", "section": "医療倫理学", "type": "fitb", "question": "死亡により財産関係が一定の身分関係にある者へ包括的に移転することを（　）という。", "answers": ["相続", "そうぞく"], "explanation": "相続。"}, {"id": "Q014", "section": "医療倫理学", "type": "fitb", "question": "相続については（　）法に規定されている。", "answers": ["民", "民法"], "explanation": "民法。"}, {"id": "Q015", "section": "健康社会学", "type": "fitb", "question": "健康なまち：住民が（　）的に健康づくり活動に参加し価値を学ぶ地域社会。", "answers": ["主体", "主体的"], "explanation": "主体的に参加。"}, {"id": "Q016", "section": "健康社会学", "type": "fitb", "question": "健康なまち：活動を通して（　）の大切さを知る。", "answers": ["生命"], "explanation": "生命の大切さ。"}, {"id": "Q017", "section": "健康社会学", "type": "fitb", "question": "健康なまち：活動を通して（　）の豊かさを味わう。", "answers": ["生活"], "explanation": "生活の豊かさ。"}, {"id": "Q018", "section": "健康社会学", "type": "fitb", "question": "健康なまち：活動を通して（　）の意義を学ぶ。", "answers": ["人生"], "explanation": "人生の意義。"}, {"id": "Q019", "section": "健康社会学", "type": "fitb", "question": "健康なまち：そして（　）を実感できる。", "answers": ["幸福", "しあわせ"], "explanation": "幸福を実感。"}, {"id": "Q020", "section": "健康社会学", "type": "fitb", "question": "HPH：患者だけでなく（　）スタッフや（　）住民にも健康づくり。", "answers": ["医療", "地域"], "explanation": "医療スタッフ・地域住民。"}, {"id": "Q021", "section": "生物学", "type": "fitb", "question": "２つのアミノ酸が結合するときに外れる分子は（　）。", "answers": ["水", "h2o", "Ｈ２Ｏ"], "explanation": "縮合で水が外れる。"}, {"id": "Q022", "section": "生物学", "type": "fitb", "question": "結合する２つの分子の名称は（　）。", "answers": ["アミノ酸"], "explanation": "アミノ酸同士。"}, {"id": "Q023", "section": "生物学", "type": "fitb", "question": "２つのアミノ酸の結合の名称は（　）結合。", "answers": ["ペプチド"], "explanation": "ペプチド結合。"}, {"id": "Q024", "section": "生物学", "type": "fitb", "question": "ヒトの染色体の本数は（　）本。", "answers": ["46", "４６"], "explanation": "体細胞は46本。"}, {"id": "Q025", "section": "生物学", "type": "fitb", "question": "形態学的に定義された細胞死は（　）。", "answers": ["アポトーシス", "apoptosis", "アポトージス"], "explanation": "アポトーシス。"}, {"id": "Q026", "section": "生物学", "type": "fitb", "question": "セントラルドグマ：遺伝情報は（　）→（　）→（　）。", "answers": ["dna→rna→タンパク質", "dna→rna→たんぱく質", "dna → rna → タンパク質", "dna rna タンパク質"], "explanation": "DNA→RNA→タンパク質。"}, {"id": "Q027", "section": "生物学", "type": "fitb", "question": "DNAを合成する酵素は（　）ポリメラーゼ。", "answers": ["dna"], "explanation": "DNAポリメラーゼ。"}, {"id": "Q028", "section": "生物学", "type": "fitb", "question": "DNA量グラフで示されるのは（　）分裂。", "answers": ["減数", "減数分裂"], "explanation": "減数分裂。"}, {"id": "Q029", "section": "生物学", "type": "fitb", "question": "構造式の2’位にOHがあるのは（　）。", "answers": ["rna", "ＲＮＡ"], "explanation": "2'OHはRNAの特徴。"}, {"id": "Q030", "section": "生物学", "type": "fitb", "question": "外界と血液とのガス交換＝（　）呼吸。", "answers": ["外", "外呼吸"], "explanation": "外呼吸。"}, {"id": "Q031", "section": "化学", "type": "fitb", "question": "各元素の基本粒子＝（　）。", "answers": ["原子"], "explanation": "原子。"}, {"id": "Q032", "section": "化学", "type": "fitb", "question": "原子は原子核と（　）からなる。", "answers": ["電子"], "explanation": "電子。"}, {"id": "Q033", "section": "化学", "type": "fitb", "question": "原子核は陽子と（　）からなる。", "answers": ["中性子"], "explanation": "中性子。"}, {"id": "Q034", "section": "化学", "type": "fitb", "question": "陽子は（　）電荷をもつ。", "answers": ["正", "プラス"], "explanation": "正電荷。"}, {"id": "Q035", "section": "化学", "type": "fitb", "question": "酸素とオゾンのように性質が異なる単体同士＝（　）。", "answers": ["同素体"], "explanation": "同素体。"}, {"id": "Q036", "section": "化学", "type": "fitb", "question": "モルとは物質量の（　）単位。", "answers": ["基本"], "explanation": "基本単位。"}, {"id": "Q037", "section": "化学", "type": "fitb", "question": "アボガドロ数は 6.02×10^（　）。", "answers": ["23", "２３"], "explanation": "6.02×10^23。"}, {"id": "Q038", "section": "化学", "type": "fitb", "question": "0℃1気圧でCO2が67.2L →（　）モル。", "answers": ["3", "３"], "explanation": "22.4L/モルより3モル。"}, {"id": "Q039", "section": "化学", "type": "fitb", "question": "pHは酸塩基の（　）のものさし。", "answers": ["強さ"], "explanation": "強さの尺度。"}, {"id": "Q040", "section": "化学", "type": "fitb", "question": "中性のpHは（　）。", "answers": ["7", "７"], "explanation": "pH7。"}, {"id": "Q041", "section": "化学", "type": "mc", "question": "P1V1=P2V2 を表す法則は？", "choices": ["ボイルの法則", "シャルルの法則", "ゲイリュサックの法則", "ドルトンの法則"], "answer": 0, "explanation": "圧力と体積の反比例＝ボイルの法則。"}, {"id": "Q042", "section": "化学", "type": "fitb", "question": "元素表記 16/8 O：16は（　）数。", "answers": ["質量", "質量数"], "explanation": "質量数。"}, {"id": "Q043", "section": "化学", "type": "fitb", "question": "元素表記 16/8 O：8は（　）番号。", "answers": ["原子", "原子番号"], "explanation": "原子番号。"}, {"id": "Q044", "section": "化学", "type": "fitb", "question": "元素記号 O の日本語名は（　）。", "answers": ["酸素"], "explanation": "酸素。"}, {"id": "Q045", "section": "解剖学", "type": "fitb", "question": "骨断面：内部は（　）骨、表層は（　）骨。", "answers": ["海綿,緻密", "海綿骨,緻密骨", "かいめん,ちみつ"], "explanation": "海綿骨と緻密骨。"}, {"id": "Q046", "section": "解剖学", "type": "fitb", "question": "断面の名称：前額面・（　）面・（　）面。", "answers": ["水平", "矢状"], "explanation": "前額（前頭）・水平・矢状。"}, {"id": "Q047", "section": "解剖学", "type": "fitb", "question": "15種23個の骨からなる頭部の総称は（　）。", "answers": ["頭蓋", "とうがい"], "explanation": "頭蓋。"}, {"id": "Q048", "section": "解剖学", "type": "fitb", "question": "食物中の栄養素を吸収可能に分解する過程は（　）。", "answers": ["消化"], "explanation": "消化。"}, {"id": "Q049", "section": "解剖学", "type": "fitb", "question": "消化産物を血管やリンパ管に送り込むのは（　）。", "answers": ["吸収"], "explanation": "吸収。"}, {"id": "Q050", "section": "歯の解剖学", "type": "fitb", "question": "小臼歯咬合面の突起で問題となるのは（　）結節。", "answers": ["中心"], "explanation": "中心結節。"}, {"id": "Q051", "section": "歯の解剖学", "type": "fitb", "question": "中心結節が原因で起こり得る疾患は（　）。", "answers": ["歯髄炎"], "explanation": "咬合干渉→破折→歯髄炎など。"}, {"id": "Q052", "section": "歯の解剖学", "type": "fitb", "question": "乳歯は生後（　）か月から萌出、合計（　）本。", "answers": ["6,20", "６,２０"], "explanation": "生後6か月〜、20本。"}, {"id": "Q053", "section": "歯の解剖学", "type": "fitb", "question": "乳歯の脱落開始は（　）歳、完了は（　）歳ごろ。", "answers": ["7,11", "７,１１"], "explanation": "およそ7歳開始、11歳完了。"}, {"id": "Q054", "section": "歯の解剖学", "type": "fitb", "question": "出生時すでに歯があり舌潰瘍→（　）病。", "answers": ["リガ・フェーデ", "リガフェーデ", "リガ・フェーデ病"], "explanation": "リガ・フェーデ病。"}, {"id": "Q055", "section": "歯の解剖学", "type": "fitb", "question": "乳歯列側方面観の上顎BC間・下顎CD間の空隙は（　）。", "answers": ["霊長空隙"], "explanation": "霊長空隙。"}, {"id": "Q056", "section": "歯の解剖学", "type": "fitb", "question": "前歯唇面にみられる発育溝の隆起は（　）徴。", "answers": ["隅角", "隅角徴"], "explanation": "隅角徴。"}, {"id": "Q057", "section": "生理学", "type": "fitb", "question": "心臓のペースメーカーは（　）結節。", "answers": ["洞房", "どうぼう", "洞房結節"], "explanation": "洞房結節。"}, {"id": "Q058", "section": "生理学", "type": "fitb", "question": "血管損傷部に凝集する血球成分は（　）。", "answers": ["血小板"], "explanation": "血小板。"}, {"id": "Q059", "section": "生理学", "type": "fitb", "question": "細胞と血液のガス交換＝（　）呼吸。", "answers": ["内", "内呼吸"], "explanation": "内呼吸。"}, {"id": "Q060", "section": "生理学", "type": "fitb", "question": "泌尿器は腎臓・尿管・（　）・（　）から構成。", "answers": ["膀胱", "尿道"], "explanation": "腎臓・尿管・膀胱・尿道。"}, {"id": "Q061", "section": "生理学", "type": "fitb", "question": "胃主細胞の分泌物は（　）。", "answers": ["ペプシノーゲン", "ペプシン"], "explanation": "ペプシノーゲン→ペプシン。"}, {"id": "Q062", "section": "生理学", "type": "fitb", "question": "胃壁細胞の分泌物は（　）と（　）。", "answers": ["塩酸", "内因子"], "explanation": "塩酸と内因子。"}, {"id": "Q063", "section": "生理学", "type": "fitb", "question": "A＝外分泌腺、B＝内分泌腺。Bの分泌物は（　）に放出。", "answers": ["血中", "血液"], "explanation": "内分泌＝血中へ。"}, {"id": "Q064", "section": "生理学", "type": "fitb", "question": "体温：一定なのは（　）温度、環境に影響されるのは（　）温度。", "answers": ["体内", "体表"], "explanation": "体内温度／体表温度。"}, {"id": "Q065", "section": "生理学", "type": "fitb", "question": "安静時熱産生が最も大きい臓器は（　）、次いで（　）。", "answers": ["骨格筋", "肝臓"], "explanation": "骨格筋＞肝臓。"}, {"id": "Q066", "section": "生理学", "type": "fitb", "question": "水分蒸散：体表から（　）として蒸発。不感蒸泄と（　）がある。", "answers": ["水蒸気", "発汗"], "explanation": "水蒸気・不感蒸泄・発汗。"}, {"id": "Q067", "section": "組織・発生学", "type": "fitb", "question": "細胞膜：リン脂質の（　）層と膜（　）。", "answers": ["二重", "タンパク質", "たんぱく質"], "explanation": "リン脂質二重層と膜タンパク質。"}, {"id": "Q068", "section": "組織・発生学", "type": "fitb", "question": "ミトコンドリアでは（　）の合成が行われる。", "answers": ["atp", "ＡＴＰ"], "explanation": "ATP合成。"}, {"id": "Q069", "section": "組織・発生学", "type": "fitb", "question": "リボソームでは（　）の合成が行われる。", "answers": ["タンパク質", "たんぱく質"], "explanation": "タンパク質合成。"}, {"id": "Q070", "section": "組織・発生学", "type": "fitb", "question": "遺伝子：DNAのうち体内で合成される（　）の種類を決める部分。", "answers": ["タンパク質", "たんぱく質"], "explanation": "タンパク質の種類を指定。"}, {"id": "Q071", "section": "組織・発生学", "type": "fitb", "question": "体細胞分裂：1つの細胞が分裂し（　）つの細胞に。", "answers": ["2", "２"], "explanation": "2つ。"}, {"id": "Q072", "section": "組織・発生学", "type": "fitb", "question": "分裂装置：（　）体が現れる（　）分裂。", "answers": ["紡錘", "有糸", "紡錘体,有糸分裂"], "explanation": "紡錘体／有糸分裂。"}, {"id": "Q073", "section": "組織・発生学", "type": "fitb", "question": "細胞が分裂し次の分裂に至るまでの周期は（　）周期。", "answers": ["細胞"], "explanation": "細胞周期。"}, {"id": "Q074", "section": "組織・発生学", "type": "fitb", "question": "糸球体でのろ過は（　）輸送。タンパク質は（　）。", "answers": ["受動", "ろ過されない", "受動輸送,ろ過されない"], "explanation": "受動輸送／ろ過されない。"}, {"id": "Q075", "section": "組織・発生学", "type": "fitb", "question": "口腔粘膜上皮（模式図）：（　）上皮。", "answers": ["重層扁平", "じゅうそうへんぺい", "重層扁平上皮"], "explanation": "重層扁平上皮。"}, {"id": "Q076", "section": "組織・発生学", "type": "fitb", "question": "一般的な結合組織：主成分は（　）線維と（　）細胞。", "answers": ["膠原", "線維芽"], "explanation": "膠原線維と線維芽細胞。"}, {"id": "Q077", "section": "組織・発生学", "type": "fitb", "question": "骨改造＝（　）。", "answers": ["リモデリング", "リモデリング"], "explanation": "リモデリング。"}, {"id": "Q078", "section": "組織・発生学", "type": "fitb", "question": "三胚葉：（　）胚葉・（　）胚葉・（　）胚葉。", "answers": ["外", "中", "内"], "explanation": "外・中・内胚葉。"}, {"id": "Q079", "section": "組織・発生学", "type": "fitb", "question": "骨は三胚葉のうち（　）胚葉由来。", "answers": ["中", "中胚葉"], "explanation": "中胚葉。"}, {"id": "Q080", "section": "組織・発生学", "type": "fitb", "question": "表皮・爪・毛は（　）胚葉由来。", "answers": ["外", "外胚葉"], "explanation": "外胚葉。"}, {"id": "Q081", "section": "組織・発生学", "type": "fitb", "question": "胎盤のはたらき（ホルモン以外）：（　）交換。", "answers": ["物質", "ぶっしつ"], "explanation": "物質交換。"}, {"id": "Q082", "section": "組織・発生学", "type": "fitb", "question": "胎盤で産生されるホルモン：（　）。", "answers": ["hcg", "ヒト絨毛性ゴナドトロピン", "ヒト絨毛性ゴナドトロピン(hcg)"], "explanation": "hCG。"}, {"id": "Q083", "section": "組織・発生学", "type": "fitb", "question": "hCGは妊娠（　）期に大きく増加→妊娠の判定に利用。", "answers": ["初", "初期"], "explanation": "妊娠初期。"}, {"id": "Q084", "section": "組織・発生学", "type": "fitb", "question": "上唇形成：内側鼻突起と（　）突起が癒合。", "answers": ["上顎"], "explanation": "内側鼻突起＋上顎突起。"}, {"id": "Q085", "section": "組織・発生学", "type": "fitb", "question": "写真の病態：口唇（　）。", "answers": ["口蓋裂", "こうがいれつ", "口唇口蓋裂", "口唇こうがい裂"], "explanation": "口唇口蓋裂。"}, {"id": "Q086", "section": "組織・発生学", "type": "fitb", "question": "歯胚の構成：（　）器・（　）・（　）。", "answers": ["エナメル", "歯乳頭", "歯小嚢"], "explanation": "エナメル器・歯乳頭・歯小嚢。"}, {"id": "Q087", "section": "組織・発生学", "type": "fitb", "question": "象牙質／歯髄境界付近：矢印は（　）突起、（　）細胞。", "answers": ["象牙芽", "象牙芽"], "explanation": "象牙芽細胞突起・象牙芽細胞。"}, {"id": "Q088", "section": "組織・発生学", "type": "fitb", "question": "（a）質と（b）は複合体→（b）＝（　）。", "answers": ["歯髄"], "explanation": "象牙質・歯髄複合体。"}, {"id": "Q089", "section": "生化学", "type": "fitb", "question": "-CHO は（　）基。", "answers": ["アルデヒド"], "explanation": "アルデヒド基。"}, {"id": "Q090", "section": "生化学", "type": "fitb", "question": "グルコースは（　）炭糖。", "answers": ["六", "6", "６"], "explanation": "六炭糖。"}, {"id": "Q091", "section": "生化学", "type": "fitb", "question": "炭化水素基に二重結合のない脂肪酸＝（　）脂肪酸。", "answers": ["飽和"], "explanation": "飽和脂肪酸。"}, {"id": "Q092", "section": "生化学", "type": "fitb", "question": "必須アミノ酸を1つ挙げよ（例）。", "answers": ["バリン", "ロイシン", "イソロイシン", "トリプトファン", "メチオニン", "フェニルアラニン", "スレオニン", "リジン", "ヒスチジン"], "explanation": "9種類のいずれか。"}, {"id": "Q093", "section": "生化学", "type": "fitb", "question": "不足で味覚異常を生じる元素は（　）。", "answers": ["亜鉛"], "explanation": "亜鉛。"}, {"id": "Q094", "section": "生化学", "type": "fitb", "question": "ビタミンAは（　）溶性。", "answers": ["脂"], "explanation": "脂溶性。"}, {"id": "Q095", "section": "生化学", "type": "fitb", "question": "（　）化＝『つくる過程』の代謝。", "answers": ["同化"], "explanation": "同化。"}, {"id": "Q096", "section": "生化学", "type": "fitb", "question": "栄養素は主に（　）粘膜上皮細胞から吸収。", "answers": ["小腸"], "explanation": "小腸。"}, {"id": "Q097", "section": "生化学", "type": "fitb", "question": "食物中の脂質の約95%は（　）。", "answers": ["トリグリセリド", "中性脂肪"], "explanation": "トリグリセリド（中性脂肪）。"}, {"id": "Q098", "section": "生化学", "type": "fitb", "question": "脂肪酸のβ酸化はミトコンドリアの（　）で行われる。", "answers": ["マトリックス"], "explanation": "ミトコンドリアマトリックス。"}, {"id": "Q099", "section": "生化学", "type": "fitb", "question": "ヌクレオチドの構成成分3つ：（　）糖・（　）・（　）。", "answers": ["五炭", "リン酸", "塩基"], "explanation": "五炭糖・リン酸・塩基。"}, {"id": "Q100", "section": "生化学", "type": "fitb", "question": "同じDNAのコピーを作る過程＝（　）。", "answers": ["複製"], "explanation": "DNA複製。"}, {"id": "Q101", "section": "生化学", "type": "fitb", "question": "mRNAの情報からタンパク質を合成する過程＝（　）。", "answers": ["翻訳"], "explanation": "翻訳。"}, {"id": "Q102", "section": "歯科予防処置I", "type": "mc", "question": "第一次予防に含まれるのはどれ？", "choices": ["健康教育・禁煙・適切な運動", "早期発見と即時処置", "リハビリテーション", "咬合調整・外科処置"], "answer": 0, "explanation": "健康増進・特異的予防が第一次。"}, {"id": "Q103", "section": "歯科予防処置I", "type": "fitb", "question": "歯周組織4つ：（　）、（　）、（　）、（　）。", "answers": ["歯肉,歯根膜,セメント質,歯槽骨", "歯肉,歯根膜,セメント,歯槽骨"], "explanation": "歯肉／歯根膜／セメント質／歯槽骨。"}, {"id": "Q104", "section": "歯科予防処置I", "type": "fitb", "question": "大唾液腺3つ：（　）腺・（　）腺・（　）腺。", "answers": ["耳下", "顎下", "舌下"], "explanation": "耳下腺・顎下腺・舌下腺。"}, {"id": "Q105", "section": "歯科予防処置I", "type": "fitb", "question": "嚥下5期：（　）期→口腔準備→口腔→（　）→（　）。", "answers": ["先行", "咽頭", "食道"], "explanation": "先行→口腔準備→口腔→咽頭→食道。"}, {"id": "Q106", "section": "歯科予防処置I", "type": "mc", "question": "う蝕C2はどこまで？", "choices": ["エナメル質内", "象牙質まで", "歯髄まで", "残根状態"], "answer": 1, "explanation": "C2＝象牙質まで。"}, {"id": "Q107", "section": "歯科予防処置I", "type": "mc", "question": "健康歯肉の特徴で正しいのは？", "choices": ["淡いピンクでスティップリングあり", "発赤腫脹・ポケット形成", "アタッチメントロスがある", "排膿がみられる"], "answer": 0, "explanation": "健康歯肉＝淡いピンク、張り、スティップリング。"}, {"id": "Q108", "section": "歯科予防処置I", "type": "mc", "question": "デンチャープラークが関与しやすい疾患は？", "choices": ["口角炎", "カンジダ症", "白板症", "地図状舌"], "answer": 1, "explanation": "義歯表面の真菌付着→カンジダ症の一因。"}, {"id": "Q109", "section": "歯科保健指導論I", "type": "fitb", "question": "保健指導：対象の（　）を育て、好ましい（　）を養成する。", "answers": ["意欲", "行動"], "explanation": "意欲・行動。"}, {"id": "Q110", "section": "歯科保健指導論I", "type": "mc", "question": "ヘルスプロモーションで正しいのは？（2つのうち1つを選択問題化）", "choices": ["健康日本21の基盤", "人を対象とする倫理規範"], "answer": 0, "explanation": "健康日本21の基盤。"}, {"id": "Q111", "section": "歯科保健指導論I", "type": "mc", "question": "ポピュレーションアプローチに該当するのは？", "choices": ["喫煙者教室", "高校生への食育", "糖尿病予備軍への指導", "個別カウンセリング"], "answer": 1, "explanation": "集団全体への食育はポピュレーション。"}, {"id": "Q112", "section": "歯科保健指導論I", "type": "mc", "question": "面接の技法として適切な組合せは？", "choices": ["傾聴とオープンクエスチョン", "誘導尋問と詰問", "クローズド中心"], "answer": 0, "explanation": "傾聴・オープン質問を活用。"}, {"id": "Q113", "section": "歯科診療補助I", "type": "mc", "question": "AED準備後、『除細動を行う』と指示→次の対応は？", "choices": ["脈を触知する", "患者に触れない", "人工呼吸を続ける", "呼吸を確認する"], "answer": 1, "explanation": "ショック実行時は誰も触れない。"}, {"id": "Q114", "section": "歯科診療補助I", "type": "mc", "question": "パルスオキシメータの装着部位：適切なのは？", "choices": ["耳朶・指先", "腋窩・前額", "舌・鼻翼", "手背・足背のみ"], "answer": 0, "explanation": "一般に耳朶・指先など。"}, {"id": "Q115", "section": "歯科診療補助I", "type": "mc", "question": "外科用吸引で術野確保・出血部吸引などに使う器具は？", "choices": ["サクションチップ", "滅菌ガーゼ", "三方活栓", "綿球"], "answer": 0, "explanation": "サクションで術野確保。"}, {"id": "Q116", "section": "歯科診療補助I", "type": "mc", "question": "自動血圧計のマンシェット装着で適切なのは？", "choices": ["肘窩の上方で動脈に合わせる", "手関節中心に巻く", "肩に巻く", "どこでもよい"], "answer": 0, "explanation": "上腕動脈に合わせて装着。"}];

function normalizeText(s){ if(!s) return ""; const z={"０":"0","１":"1","２":"2","３":"3","４":"4","５":"5","６":"6","７":"7","８":"8","９":"9"}; s=s.toString().trim().toLowerCase(); s=s.replace(/[\u3000\s]+/g,""); s=s.replace(/[０-９]/g, ch=>z[ch]||ch); return s; }
function shuffleArray(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }
function saveLocal(k,v){ try{localStorage.setItem(k, JSON.stringify(v));}catch(e){} }
function loadLocal(k,f){ try{const v=JSON.parse(localStorage.getItem(k)||"null"); return (v==null?f:v);}catch(e){return f;} }

let order=[], idx=0, correct=0, wrongIds=[], current=null;

let shuffleChk, shuffleChoicesChk, saveScoreChk, quizEl, statusEl;

function init(){
  shuffleChk=document.getElementById('shuffle');
  shuffleChoicesChk=document.getElementById('shuffleChoices');
  saveScoreChk=document.getElementById('saveScore');
  quizEl=document.getElementById('quiz'); statusEl=document.getElementById('status');
  document.getElementById('start').addEventListener('click', startAll);
  document.getElementById('mistOnly').addEventListener('click', startMistOnly);
  renderWelcome();
  if('serviceWorker' in navigator){ try{ const sw=`self.addEventListener('install', e=>{e.waitUntil(caches.open('summer-quiz-v1').then(c=>c.addAll(['./'])));}); self.addEventListener('fetch', e=>{e.respondWith(caches.match(e.request).then(r=>r||fetch(e.request)));});`; const blob=new Blob([sw],{type:'text/javascript'}); const url=URL.createObjectURL(blob); navigator.serviceWorker.register(url);}catch(e){} }
}

function renderWelcome(){
  const best=loadLocal('summerQuizBest', null); const mist=loadLocal('summerQuizWrong', []);
  let html = `<div class="card"><div class="qtext"><strong>ようこそ。</strong> 上の「開始 / 最初から」でスタート。学習モードはその場で解説、試験モードは採点を行います。</div>
  <div class="meta">問題数：${QBANK.length} ／ セクション数：${new Set(QBANK.map(x=>x.section)).size}</div>`;
  if(best) html += `<div class="pill">ベストスコア：${best.score} / ${best.total}（${best.date}）</div>`;
  if(mist && mist.length) html += `<div class="pill">暗記用に未正解：${mist.length}題</div>`;
  html += `</div>`;
  quizEl.innerHTML = html; statusEl.textContent = "";
}

function startAll(){ order=QBANK.map((_,i)=>i); if(shuffleChk.checked) shuffleArray(order); idx=0; correct=0; wrongIds=[]; next(); }
function startMistOnly(){
  const mist=loadLocal('summerQuizWrong', []); if(!mist || !mist.length){ alert('暗記モード：未正解の蓄積がありません。'); return; }
  const id2idx=new Map(QBANK.map((q,i)=>[q.id,i])); order=mist.map(qid=>id2idx.get(qid)).filter(i=>i!=null);
  if(!order.length){ alert('暗記モードに出題できる問題がありません。'); return; }
  if(shuffleChk.checked) shuffleArray(order); idx=0; correct=0; wrongIds=[]; next();
}

function next(){ if(idx>=order.length){ finish(); return; } const q=QBANK[order[idx]]; renderQuestion(q); }

function renderQuestion(q){
  let html = `<div class="card"><div class="meta">ID: ${q.id} ／ セクション：${q.section} ／ ${idx+1} / ${order.length}</div><div class="qtext">${q.question}</div>`;
  if(q.type==="mc"){
    let ch=q.choices.map((c,i)=>({c,i})); if(shuffleChoicesChk && shuffleChoicesChk.checked) shuffleArray(ch);
    html += `<div class="choices">` + ch.map(o=>`<div class="choice" data-i="${o.i}">${o.c}</div>`).join("") + `</div>`;
  }else{
    html += `<div class="fitb"><input id="fitb" type="text" placeholder="解答を入力"><button class="primary" id="fitbBtn">回答</button></div>`;
  }
  html += `<div id="res" class="res"></div><div id="ex" class="ex" style="display:none"></div><div class="controls"><button id="nextBtn">次へ</button></div></div>`;
  quizEl.innerHTML = html;
  if(q.type==="mc"){
    Array.from(document.querySelectorAll('.choice')).forEach(el=>{
      el.addEventListener('click', ()=>checkMC(parseInt(el.getAttribute('data-i'),10), q));
    });
  }else{
    document.getElementById('fitbBtn').addEventListener('click', ()=>checkFITB(q));
    document.getElementById('fitb').addEventListener('keydown', (e)=>{ if(e.key==='Enter') checkFITB(q); });
  }
  document.getElementById('nextBtn').addEventListener('click', ()=>{ idx++; next(); });
  statusEl.textContent = `正解：${correct}／${idx}`;
}

function checkMC(chIdx, q){
  const res=document.getElementById('res'), ex=document.getElementById('ex'); const ok=(chIdx===q.answer); const mark= ok? "◯":"×";
  res.innerHTML = ok ? `<span class='ok'>${mark} 正解！</span>` : `<span class='bad'>${mark} 不正解</span>`;
  ex.style.display='block'; ex.textContent = q.explanation || "";
  if(ok) correct++; else wrongIds.push(q.id);
  statusEl.textContent = `正解：${correct}／${idx+1}`;
}

function checkFITB(q){
  const inp=document.getElementById('fitb'); const res=document.getElementById('res'); const ex=document.getElementById('ex');
  const user=normalizeText(inp.value); const acceptable=(q.answers||[]).map(normalizeText);
  const ok = acceptable.some(a => a===user || (a.includes(",") && a.split(",").every(part => user.includes(part))));
  const mark= ok? "◯":"×";
  res.innerHTML = ok ? `<span class='ok'>${mark} 正解！</span>` : `<span class='bad'>${mark} 不正解</span>`;
  ex.style.display='block'; ex.textContent = q.explanation || "";
  if(ok) correct++; else wrongIds.push(q.id);
  statusEl.textContent = `正解：${correct}／${idx+1}`;
}

function finish(){
  const total=order.length;
  quizEl.innerHTML = `<div class="card"><div class="qtext"><strong>結果</strong>：${correct} / ${total}</div>
    <div class="meta">未正解：${total-correct}題</div>
    <div class="controls"><button class="primary" id="restart">最初から</button><button id="memorize">暗記モード（未正解のみ）</button></div></div>`;
  document.getElementById('restart').addEventListener('click', startAll);
  document.getElementById('memorize').addEventListener('click', startMistOnly);
  statusEl.textContent = `正解：${correct}／${total}`;
  if(saveScoreChk && saveScoreChk.checked){
    const best=loadLocal('summerQuizBest', null); const rec={score:correct,total:total,date:new Date().toLocaleString()};
    if(!best || (correct/total)>(best.score/best.total)) saveLocal('summerQuizBest', rec);
    // unique wrong ids
    saveLocal('summerQuizWrong', [...new Set(wrongIds)]);
  }
}

window.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
